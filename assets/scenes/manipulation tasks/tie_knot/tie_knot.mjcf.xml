<?xml version="1.0" ?>
<mujoco model="dual UR5e setup">
  <compiler angle="radian" autolimits="true" assetdir="assets" meshdir="assets" texturedir="assets"/>
  <!--<statistic center="0.2 0 0.4" extent=".65"/>-->
  <visual>
    <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0"/>
    <rgba haze="0.15 0.25 0.35 1"/>
    <global azimuth="150" elevation="-20" offwidth="1280" offheight="1024"/>
  </visual>
  <asset>
    <texture type="skybox" builtin="gradient" rgb1="0.9 0.7 0.9" rgb2="0.94 0.97 0.97" width="512" height="3072"/>
    <texture type="2d" name="groundplane" builtin="checker" mark="edge" rgb1="0.2 0.3 0.4" rgb2="0.1 0.2 0.3" markrgb="0.8 0.8 0.8" width="300" height="300"/>
    <material name="groundplane" texture="groundplane" texuniform="true" texrepeat="5 5" reflectance="0.2"/>
    <material name="table-concrete" rgba="0.8 0 0 0.0" shininess="0.5"/>
    <!--Materials ported from MTL file-->
    <material name="table_optical-mat_1" rgba="0.501961 0.517647 0.501961 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_2" rgba="1 1 1 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_3" rgba="0.752941 0.752941 0.752941 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_4" rgba="0.647059 0.619608 0.588235 1.0" roughness="0" shininess="1" specular="0.4"/>
    <!--Good wood-like color for tabletop-->
    <material name="table_optical-mat_5" rgba="0.101961 0.101961 0.101961 1.0" roughness="0" shininess="1" specular="0.4"/>
    <!--Dark color for legs/structure-->
    <material name="table_optical-mat_6" rgba="0.109804 0.109804 0.109804 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_7" rgba="0.792157 0.819608 0.933333 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_8" rgba="0.529412 0.549020 0.549020 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_9" rgba="0.098039 0.098039 0.098039 1.0" shininess=""/>
    <material name="table_optical-mat_10" rgba="0 0 0 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_11" rgba="0.294118 0.294118 0.294118 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_12" rgba="0.250980 0.250980 0.250980 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_13" rgba="0.698039 0.698039 0.698039 1.0" roughness="0" shininess="1" specular="0.4"/>
    <material name="table_optical-mat_14" rgba="0.956863 0.956863 0.956863 1.0" roughness="0" shininess="1" specular="0.4"/>
    <mesh name="optical_table-model_0" file="model/model_0.obj"/>
    <mesh name="optical_table-model_1" file="model/model_1.obj"/>
    <mesh name="optical_table-model_2" file="model/model_2.obj"/>
    <mesh name="optical_table-model_3" file="model/model_3.obj"/>
    <mesh name="optical_table-model_4" file="model/model_4.obj"/>
    <mesh name="optical_table-model_5" file="model/model_5.obj"/>
    <mesh name="optical_table-model_6" file="model/model_6.obj"/>
    <mesh name="optical_table-model_7" file="model/model_7.obj"/>
    <mesh name="optical_table-model_8" file="model/model_8.obj"/>
    <mesh name="optical_table-model_9" file="model/model_9.obj"/>
    <mesh name="optical_table-model_10" file="model/model_10.obj"/>
    <mesh name="optical_table-model_11" file="model/model_11.obj"/>
    <mesh name="optical_table-model_12" file="model/model_12.obj"/>
    <mesh name="optical_table-model_13" file="model/model_13.obj"/>
    <material class="2f85" name="2f85-metal" rgba="0.58 0.58 0.58 1"/>
    <material class="2f85" name="2f85-silicone" rgba="0.1882 0.1882 0.1882 1"/>
    <material class="2f85" name="2f85-gray" rgba="0.4627 0.4627 0.4627 1"/>
    <material class="2f85" name="2f85-black" rgba="0.149 0.149 0.149 1"/>
    <mesh class="2f85" file="robotiq_2f85/base_mount.stl"/>
    <mesh class="2f85" file="robotiq_2f85/base.stl"/>
    <mesh class="2f85" file="robotiq_2f85/driver.stl"/>
    <mesh class="2f85" file="robotiq_2f85/coupler.stl"/>
    <mesh class="2f85" file="robotiq_2f85/follower.stl"/>
    <mesh class="2f85" file="robotiq_2f85/pad.stl"/>
    <mesh class="2f85" file="robotiq_2f85/silicone_pad.stl"/>
    <mesh class="2f85" file="robotiq_2f85/spring_link.stl"/>
  </asset>
  <extension>
    <plugin plugin="mujoco.elasticity.cable"/>
  </extension>
  <default>
    <default class="optical_table-visual">
      <geom group="2" type="mesh" contype="0" conaffinity="0"/>
    </default>
    <default class="optical_table-collision">
      <geom group="3" type="mesh"/>
    </default>
    <default class="2f85">
      <mesh scale="0.001 0.001 0.001"/>
      <general biastype="affine"/>
      <joint axis="1 0 0"/>
      <default class="2f85-driver">
        <joint range="0 0.8" armature="0.005" damping="0.1" solimplimit="0.95 0.99 0.001" solreflimit="0.005 1"/>
      </default>
      <default class="2f85-follower">
        <joint range="-0.872664 0.872664" armature="0.001" pos="0 -0.018 0.0065" solimplimit="0.95 0.99 0.001" solreflimit="0.005 1"/>
      </default>
      <default class="2f85-spring_link">
        <joint range="-0.29670597283 0.8" armature="0.001" stiffness="0.05" springref="2.62" damping="0.00125"/>
      </default>
      <default class="2f85-coupler">
        <joint range="-1.57 0" armature="0.001" solimplimit="0.95 0.99 0.001" solreflimit="0.005 1"/>
      </default>
      <default class="2f85-visual">
        <geom type="mesh" contype="0" conaffinity="0" group="0"/>
      </default>
      <default class="2f85-collision">
        <geom type="mesh" group="3"/>
        <default class="2f85-pad_box1">
          <geom mass="0" type="box" pos="0 -0.0026 0.028125" size="0.011 0.004 0.009375" friction="4" solimp="0.95 0.99 0.001" solref="0.004 1" priority="1" rgba="0.55 0.55 0.55 1"/>
        </default>
        <default class="2f85-pad_box2">
          <geom mass="0" type="box" pos="0 -0.0026 0.009375" size="0.011 0.004 0.009375" friction="3" solimp="0.95 0.99 0.001" solref="0.004 1" priority="1" rgba="0.45 0.45 0.45 1"/>
        </default>
      </default>
    </default>
  </default>
  <worldbody>
    <light name="key" pos="1.0 0.5 1.7" dir="-1 -0.5 -0.5" cutoff="45" diffuse="0.3 0.3 0.3" directional="true"/>
    <light name="fill" pos="0.8 -0.7 1.6" dir="-0.8 0.5 -0.6" cutoff="60" diffuse="0.18 0.18 0.18" directional="true"/>
    <light name="back" pos="-0.8 0 2.4" dir="-1 0 1" cutoff="50" diffuse="0.5 0.5 0.5" directional="true"/>
    <camera name="left" pos="0.14 0.355 1.2" fovy="42.5" xyaxes="-1.0 0.0 0.0 0.0 -0.4046485876119067 0.9144722634086225"/>
    <camera name="right" pos="0.07500000000000001 -0.355 1.2" fovy="42.5" xyaxes="1.0 0.0 0.0 -0.0 0.4046485876119067 0.9144722634086225"/>
    <camera name="stereo_left" pos="-0.6 0.03 1.57" resolution="640 360" focalpixel="426.215 426.332" sensorsize="0.0098 0.00735" xyaxes="-0.029986509105671005 -0.9995503035223668 0.0 0.4468516474737887 -0.01340554942421366 0.8945076279130302"/>
    <camera name="stereo_right" pos="-0.6 -0.03 1.57" resolution="640 360" focalpixel="426.215 426.332" sensorsize="0.0098 0.00735" xyaxes="0.029986509105671005 -0.9995503035223668 0.0 0.4468516474737887 0.01340554942421366 0.8945076279130302"/>
    <camera name="stereo_far_right" pos="-0.6000000000000001 -0.6 1.77" resolution="640 360" focalpixel="426.215 426.332" sensorsize="0.0098 0.00735" xyaxes="0.5144957554275265 -0.8574929257125442 0.0 0.44130893612810324 0.2647853616768619 0.857400218763172"/>
    <camera name="stereo_far_left" pos="-0.6000000000000001 0.6 1.77" resolution="640 360" focalpixel="426.215 426.332" sensorsize="0.0098 0.00735" xyaxes="-0.5144957554275265 -0.8574929257125442 0.0 0.44130893612810324 -0.2647853616768619 0.857400218763172"/>
    <body name="table" pos="0 0 0.76">
      <geom name="table-concrete" type="box" group="4" material="table-concrete" size="0.7 0.7 0.05" pos="0 0 -0.05"/>
    </body>
    <body>
      <composite prefix="rope_" type="cable" curve="s" count="50 1 1" size="0.43" initial="none" offset="0.05 0 1.1">
        <plugin plugin="mujoco.elasticity.cable">
          <!--Units are in Pa (SI)-->
          <config key="twist" value="10.0"/>
          <config key="bend" value="10.0"/>
          <config key="vmax" value="0.005"/>
        </plugin>
        <joint kind="main" damping="0.0005"/>
        <geom type="capsule" size="0.008" rgba="0.7 0 0 1" condim="1" mass="0.001"/>
      </composite>
      <freejoint/>
    </body>
    <body name="rope_anchor" pos="0.05 0 1.1" quat="1 0 0 0">
      <!-- translate along x -->
      <joint name="jx" type="slide" axis="1 0 0" damping="500" frictionloss="200" armature="5"/>
      <!-- translate along y -->
      <joint name="jy" type="slide" axis="0 1 0" damping="500" frictionloss="200" armature="5"/>
      <!-- optional: rotate about z in the plane -->
      <!-- <joint name="jz" type="hinge" axis="0 0 1"
               damping="200" frictionloss="50" armature="1"/> -->
      <!-- your geoms here -->
      <geom type="sphere" size="0.01" contype="0" conaffinity="0" rgba="1 1 1 0"/>
    </body>
    <body name="table_optical" pos="-0.4 0 0.77">
      <!--<freejoint/>-->
      <geom mesh="optical_table-model_0" class="optical_table-visual" material="table_optical-mat_1"/>
      <geom mesh="optical_table-model_1" class="optical_table-visual" material="table_optical-mat_2"/>
      <geom mesh="optical_table-model_2" class="optical_table-visual" material="table_optical-mat_3"/>
      <geom mesh="optical_table-model_3" class="optical_table-visual" material="table_optical-mat_4"/>
      <geom mesh="optical_table-model_4" class="optical_table-visual" material="table_optical-mat_5"/>
      <geom mesh="optical_table-model_5" class="optical_table-visual" material="table_optical-mat_6"/>
      <geom mesh="optical_table-model_6" class="optical_table-visual" material="table_optical-mat_7"/>
      <geom mesh="optical_table-model_7" class="optical_table-visual" material="table_optical-mat_8"/>
      <geom mesh="optical_table-model_8" class="optical_table-visual" material="table_optical-mat_9"/>
      <geom mesh="optical_table-model_9" class="optical_table-visual" material="table_optical-mat_10"/>
      <geom mesh="optical_table-model_10" class="optical_table-visual" material="table_optical-mat_11"/>
      <geom mesh="optical_table-model_11" class="optical_table-visual" material="table_optical-mat_12"/>
      <geom mesh="optical_table-model_12" class="optical_table-visual" material="table_optical-mat_13"/>
      <geom mesh="optical_table-model_13" class="optical_table-visual" material="table_optical-mat_14"/>
    </body>
    <body name="gripper-float">
      <joint name="gripper-float-floating-base" type="free"/>
      <body name="gripper" pos="0.0 0 1.5" quat="0 0 1 0">
        <geom class="2f85-visual" mesh="base_mount" material="2f85-black"/>
        <geom class="2f85-collision" mesh="base_mount"/>
        <body name="gripper-base" pos="0 0 0.0038" quat="1 0 0 0">
          <inertial mass="0.05" pos="0 -2.70394e-05 0.0354675" quat="1 -0.00152849 0 0" diaginertia="0.000260285 0.000225381 0.000152708"/>
          <geom class="2f85-visual" mesh="base" material="2f85-black"/>
          <geom class="2f85-collision" mesh="base"/>
          <site name="gripper-pinch" pos="0 0 0.145" type="sphere" rgba="0.9 0.0 0.0 1" size="0.002"/>
          <camera name="wrist" pos="0.1 0.0 0.01" quat="-0.11 0.7 -0.7 0.11" fovy="42.5"/>
          <!-- Right-hand side 4-bar linkage -->
          <body name="gripper-right_driver" pos="0 0.0306011 0.054904">
            <inertial mass="0.00899563" pos="2.96931e-12 0.0177547 0.00107314" quat="0.681301 0.732003 0 0" diaginertia="1.72352e-06 1.60906e-06 3.22006e-07"/>
            <joint name="gripper-right_driver_joint" class="2f85-driver"/>
            <geom class="2f85-visual" mesh="driver" material="2f85-gray"/>
            <geom class="2f85-collision" mesh="driver"/>
            <body name="gripper-right_coupler" pos="0 0.0315 -0.0041">
              <inertial mass="0.0140974" pos="0 0.00301209 0.0232175" quat="0.705636 -0.0455904 0.0455904 0.705636" diaginertia="4.16206e-06 3.52216e-06 8.88131e-07"/>
              <joint name="gripper-right_coupler_joint" class="2f85-coupler"/>
              <geom class="2f85-visual" mesh="coupler" material="2f85-black"/>
              <geom class="2f85-collision" mesh="coupler"/>
            </body>
          </body>
          <body name="gripper-right_spring_link" pos="0 0.0132 0.0609">
            <inertial mass="0.0221642" pos="-8.65005e-09 0.0181624 0.0212658" quat="0.663403 -0.244737 0.244737 0.663403" diaginertia="8.96853e-06 6.71733e-06 2.63931e-06"/>
            <joint name="gripper-right_spring_link_joint" class="2f85-spring_link"/>
            <geom class="2f85-visual" mesh="spring_link" material="2f85-black"/>
            <geom class="2f85-collision" mesh="spring_link"/>
            <body name="gripper-right_follower" pos="0 0.055 0.0375">
              <inertial mass="0.0125222" pos="0 -0.011046 0.0124786" quat="1 0.1664 0 0" diaginertia="2.67415e-06 2.4559e-06 6.02031e-07"/>
              <joint name="gripper-right_follower_joint" class="2f85-follower"/>
              <geom class="2f85-visual" mesh="follower" material="2f85-black"/>
              <geom class="2f85-collision" mesh="follower"/>
              <body name="gripper-right_pad" pos="0 -0.0189 0.01352">
                <geom class="2f85-pad_box1" name="gripper-right_pad1"/>
                <geom class="2f85-pad_box2" name="gripper-right_pad2"/>
                <inertial mass="0.0035" pos="0 -0.0025 0.0185" quat="0.707107 0 0 0.707107" diaginertia="4.73958e-07 3.64583e-07 1.23958e-07"/>
                <geom class="2f85-visual" mesh="pad"/>
                <body name="gripper-right_silicone_pad">
                  <geom class="2f85-visual" mesh="silicone_pad" material="2f85-black"/>
                </body>
              </body>
            </body>
          </body>
          <!-- Left-hand side 4-bar linkage -->
          <body name="gripper-left_driver" pos="0 -0.0306011 0.054904" quat="0 0 0 1">
            <inertial mass="0.00899563" pos="0 0.0177547 0.00107314" quat="0.681301 0.732003 0 0" diaginertia="1.72352e-06 1.60906e-06 3.22006e-07"/>
            <joint name="gripper-left_driver_joint" class="2f85-driver"/>
            <geom class="2f85-visual" mesh="driver" material="2f85-gray"/>
            <geom class="2f85-collision" mesh="driver"/>
            <body name="gripper-left_coupler" pos="0 0.0315 -0.0041">
              <inertial mass="0.0140974" pos="0 0.00301209 0.0232175" quat="0.705636 -0.0455904 0.0455904 0.705636" diaginertia="4.16206e-06 3.52216e-06 8.88131e-07"/>
              <joint name="gripper-left_coupler_joint" class="2f85-coupler"/>
              <geom class="2f85-visual" mesh="coupler" material="2f85-black"/>
              <geom class="2f85-collision" mesh="coupler"/>
            </body>
          </body>
          <body name="gripper-left_spring_link" pos="0 -0.0132 0.0609" quat="0 0 0 1">
            <inertial mass="0.0221642" pos="-8.65005e-09 0.0181624 0.0212658" quat="0.663403 -0.244737 0.244737 0.663403" diaginertia="8.96853e-06 6.71733e-06 2.63931e-06"/>
            <joint name="gripper-left_spring_link_joint" class="2f85-spring_link"/>
            <geom class="2f85-visual" mesh="spring_link" material="2f85-black"/>
            <geom class="2f85-collision" mesh="spring_link"/>
            <body name="gripper-left_follower" pos="0 0.055 0.0375">
              <inertial mass="0.0125222" pos="0 -0.011046 0.0124786" quat="1 0.1664 0 0" diaginertia="2.67415e-06 2.4559e-06 6.02031e-07"/>
              <joint name="gripper-left_follower_joint" class="2f85-follower"/>
              <geom class="2f85-visual" mesh="follower" material="2f85-black"/>
              <geom class="2f85-collision" mesh="follower"/>
              <body name="gripper-left_pad" pos="0 -0.0189 0.01352">
                <geom class="2f85-pad_box1" name="gripper-left_pad1"/>
                <geom class="2f85-pad_box2" name="gripper-left_pad2"/>
                <inertial mass="0.0035" pos="0 -0.0025 0.0185" quat="1 0 0 1" diaginertia="4.73958e-07 3.64583e-07 1.23958e-07"/>
                <geom class="2f85-visual" mesh="pad"/>
                <body name="gripper-left_silicone_pad">
                  <geom class="2f85-visual" mesh="silicone_pad" material="2f85-black"/>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
    </body>
    <body mocap="true" name="gripper-mocap" pos="0.0 0 1.35" quat="0 0 1 0">
      <site name="gripper-mocap-site" size="0.002" type="sphere" rgba="0.13 0.3 0.2 1"/>
    </body>
  </worldbody>
  <equality>
    <weld body1="rope_B_first" body2="rope_anchor" relpose="0 0 0  1 0 0 0" solref="0.001 3" solimp="0.9 0.95 0.01"/>
    <connect anchor="0 0 0" body1="gripper-right_follower" body2="gripper-right_coupler" solimp="0.95 0.99 0.001" solref="0.005 1"/>
    <connect anchor="0 0 0" body1="gripper-left_follower" body2="gripper-left_coupler" solimp="0.95 0.99 0.001" solref="0.005 1"/>
    <joint joint1="gripper-right_driver_joint" joint2="gripper-left_driver_joint" polycoef="0 1 0 0 0" solimp="0.95 0.99 0.001" solref="0.005 1"/>
    <weld name="gripper-control" site1="gripper-mocap-site" site2="gripper-pinch"/>
  </equality>
  <contact>
    <exclude body1="gripper-base" body2="gripper-left_driver"/>
    <exclude body1="gripper-base" body2="gripper-right_driver"/>
    <exclude body1="gripper-base" body2="gripper-left_spring_link"/>
    <exclude body1="gripper-base" body2="gripper-right_spring_link"/>
    <exclude body1="gripper-right_coupler" body2="gripper-right_follower"/>
    <exclude body1="gripper-left_coupler" body2="gripper-left_follower"/>
  </contact>
  <!--This adds stability to the model by having a tendon that distributes the forces between both
      joints, such that the equality constraint doesn't have to do that much work in order to equalize
      both joints. Since both joints share the same sign, we split the force between both equally by
      setting coef=0.5-->
  <tendon>
    <fixed name="gripper-split">
      <joint joint="gripper-right_driver_joint" coef="0.5"/>
      <joint joint="gripper-left_driver_joint" coef="0.5"/>
    </fixed>
  </tendon>
  <!--The general actuator below is a customized position actuator (with some damping) where
      gainprm[0] != kp (see http://mujoco.org/book/modeling.html#position).
      The reason why gainprm[0] != kp is because the control input range has to be re-scaled to
      [0, 255]. The joint range is currently set at [0, 0.8], the control range is [0, 255] and
      kp = 100. Tau = Kp * scale * control_input - Kp * error, max(Kp * scale * control_input) = 0.8,
      hence scale = 0.8 * 100 / 255-->
  <actuator>
    <general class="2f85" name="gripper-fingers_actuator" tendon="gripper-split" forcerange="-5 5" ctrlrange="0 1" gainprm="80 0 0" biasprm="0 -100 -10"/>
  </actuator>
</mujoco>